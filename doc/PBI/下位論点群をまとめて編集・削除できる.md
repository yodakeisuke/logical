ユーザーストーリ: |
  私はディスカッションファシリテーターとして、
  既存ノード直下にぶら下がる “breakdown” とは以下の下位論点全体を削除したり、まとめて更新したりしたい。
  その結果、議論ツリーを部分的に再作成しつつ、構造の一貫性を保てる。

受け入れ条件 (BDD): |
  Rule: 正常系 ー 下位論点 を削除する
    Example: 子issue群とbreakdownをまとめて削除
      Given id=<parent-id> のノードが子ノードを2〜5件保持している
      When tool「」を parentId=<parent-id> で呼び出す
      Then 該当ノード直下の子ノードがすべて削除される
      And id=<parent-id> は leaf ノードになる
      And 更新後ツリーのJSONスナップショットを返却する
      And 同じJSONを永続ストレージへ保存する

  Rule: 正常系 ー branch を更新する
    Example: ラベルを 3 → 4 件へ置換
      Given id=<parent-id> のノードが子ノードを保持している
      And newLabels.length が2〜5
      When tool「breakdown」を適切なinputで呼び出す
      Then 旧子ノードが削除され、新しい4件の子ノードが作成される
      And 各子ノードにユニークな id が付与される
      And 更新後ツリーのJSONスナップショットを返却する
      And 同じJSONを永続ストレージへ保存する

  Rule: 異常系 ー 子ノード数が範囲外
    Example: 6件以上で update
      Given newLabels.length ≥ 6
      When tool「breakdown」を呼び出す
      Then エラーコード "TOO_MANY_CHILDREN" と
           メッセージ「ブレイクダウンが多すぎます。もっと適切な粒度を探してください。」を返す

    Example: 削除対象が leaf
      Given id=<parent-id> が leaf ノード
      When tool「branch.delete」を呼び出す
      Then エラーコード "NOT_A_BRANCH" を返す

  Rule: 異常系 ー 共通
    Example: parent-id が存在しない
      Given 不正な parentId
      When tool を呼び出す
      Then エラーコード "NODE_NOT_FOUND" を返す
